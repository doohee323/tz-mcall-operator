# Jenkins ë³µì› ì‘ì—… ê¸°ë¡

## ëª©í‘œ
Veleroì—ì„œ ê°€ì¥ ì˜¤ë˜ëœ ë°±ì—…ìœ¼ë¡œ Jenkinsë§Œ ë³µì›í•˜ë˜, í”ŒëŸ¬ê·¸ì¸ì€ ì—†ì–´ë„ ë˜ì§€ë§Œ í”„ë¡œì íŠ¸ í´ë”ëŠ” ìœ ì§€í•œ ìƒíƒœë¡œ UIë§Œ ë„ìš°ê¸°

## ì‘ì—… ë‚´ì—­

### 1ë‹¨ê³„: ì´ˆê¸° ìƒí™© íŒŒì•…
- Jenkins 2.462.3 ì‹¤í–‰ ì¤‘
- í”ŒëŸ¬ê·¸ì¸ ì—†ìŒ (Pipeline, Git, Kubernetes ë“± í•„ìˆ˜ í”ŒëŸ¬ê·¸ì¸ ë¯¸ì„¤ì¹˜)
- ë³´ì•ˆ ì·¨ì•½ì  ê²½ê³  3ê°œ ì¡´ì¬

### 2ë‹¨ê³„: í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ ì‹œë„
**ë¬¸ì œ ë°œìƒ**: í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ ì‹¤íŒ¨
```
java.nio.file.AccessDeniedException: /var/jenkins_home/plugins/structs.jpi.tmp
```

**ì›ì¸**: 
- Velero ë³µì› ì‹œ `/var/jenkins_home/plugins` ë””ë ‰í† ë¦¬ê°€ `root:root` ì†Œìœ 
- JenkinsëŠ” `jenkins:jenkins` (uid=1000)ë¡œ ì‹¤í–‰ë˜ì–´ ì“°ê¸° ê¶Œí•œ ì—†ìŒ
- fsGroupì€ ìƒˆ íŒŒì¼ì—ë§Œ ì ìš©ë˜ê³  ê¸°ì¡´ íŒŒì¼ ê¶Œí•œì€ ë³€ê²½í•˜ì§€ ì•ŠìŒ

### 3ë‹¨ê³„: ê¶Œí•œ ìˆ˜ì • ì‹œë„
**ì‹œë„ 1**: ì„ì‹œ Podë¡œ ê¶Œí•œ ìˆ˜ì •
```bash
kubectl run fix-permissions --rm -i --overrides='...'
chown -R 1000:1000 /var/jenkins_home/plugins
```
âœ… ì„±ê³µí–ˆìœ¼ë‚˜ ì¬ì‹œì‘ ì‹œ ë‹¤ì‹œ ë¬¸ì œ ë°œìƒ

**ì‹œë„ 2**: StatefulSetì— InitContainer ì¶”ê°€
```bash
kubectl patch statefulset jenkins -n jenkins --type=json -p='[...]'
```
âŒ `Init:CreateContainerConfigError` ë°œìƒ

### 4ë‹¨ê³„: ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘
**ê²°ì •**: Velero ê°€ì¥ ì˜¤ë˜ëœ ë°±ì—…ìœ¼ë¡œ ì™„ì „íˆ ìƒˆë¡œ ë³µì›

1. í˜„ì¬ Jenkins namespace ì‚­ì œ
```bash
kubectl delete namespace jenkins
```

2. Velero ë°±ì—… ëª©ë¡ í™•ì¸
- ê°€ì¥ ì˜¤ë˜ëœ ë°±ì—…: `jenkins-pre-upgrade-20251011-201802`

3. ë³µì› ì‹¤í–‰
```bash
kubectl create -f - <<EOF
apiVersion: velero.io/v1
kind: Restore
metadata:
  name: restore-jenkins-oldest-20251012-141212
  namespace: velero
spec:
  backupName: jenkins-pre-upgrade-20251011-201802
  includedNamespaces:
  - jenkins
  restorePVs: true
EOF
```
âœ… ë³µì› ì™„ë£Œ: 44ê°œ ì•„ì´í…œ ë³µì›, 7ê°œ ê²½ê³ 

### 5ë‹¨ê³„: PVC ë¬¸ì œ í•´ê²°
**ë¬¸ì œ**: Podê°€ Pending ìƒíƒœ
```
0/3 nodes are available: pod has unbound immediate PersistentVolumeClaims
```

**ì›ì¸**: 
- Veleroê°€ ë³µì›í•œ PVCê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” PVë¥¼ ì°¸ì¡°
- PV `pvc-232cfef6-a8c0-4d01-9c05-a4cfebe49938` ì—†ìŒ

**í•´ê²°**:
1. ë¬¸ì œìˆëŠ” PVC ì‚­ì œ
```bash
kubectl delete pvc jenkins -n jenkins
```

2. ìƒˆ PVC ìˆ˜ë™ ìƒì„±
```bash
kubectl apply -f - <<EOF
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: jenkins
  namespace: jenkins
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: nfs-client
  resources:
    requests:
      storage: 8Gi
EOF
```
âœ… PVC Bound ì„±ê³µ

### 6ë‹¨ê³„: Jenkins UI ë³µì› ì™„ë£Œ
- Jenkins Pod ì •ìƒ ì‹œì‘: `1/2 Running` â†’ `2/2 Running`
- UI ì ‘ê·¼ ê°€ëŠ¥: https://jenkins.drillquiz.com/
- Jenkins 2.462.3 ì •ìƒ ì‘ë™
- Build Executor: 2ê°œ Idle

## âš ï¸ í˜„ì¬ ë¬¸ì œ

### jobs í´ë”ê°€ ë¹„ì–´ìˆìŒ
```bash
jenkins@jenkins-0:~/jobs$ ls -al
total 8
drwxr-xr-x  2 jenkins jenkins 4096 Oct 12 21:15 .
drwxrwxrwx 12 root    root    4096 Oct 12 21:18 ..
```

### ì›ì¸
ìƒˆë¡œìš´ PVCë¥¼ ìƒì„±í–ˆê¸° ë•Œë¬¸ì— ì´ì „ í”„ë¡œì íŠ¸ ë°ì´í„°ê°€ ì—†ìŒ

### ë°œê²¬í•œ ê²ƒ
```bash
kubectl get pv | grep jenkins
jenkins-clean-pv                           8Gi  RWO  Retain  Released  jenkins/jenkins  nfs-client
pvc-eaee4131-828a-4e4d-a634-34d40293b581   8Gi  RWO  Delete  Bound     jenkins/jenkins  nfs-client
```
- `jenkins-clean-pv` (Released ìƒíƒœ)ì— ì´ì „ ë°ì´í„°ê°€ ìˆì„ ê°€ëŠ¥ì„±
- í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ PVCëŠ” ìƒˆë¡œ ë§Œë“  ê²ƒ (ë¹„ì–´ìˆìŒ)

## âœ… í•´ê²°ë¨: NFS ë°ì´í„° ë³µì› ì™„ë£Œ

### jenkins-clean-pv ë³µì› ì„±ê³µ
- NFS ê²½ë¡œ: `/srv/nfs/archived-jenkins-jenkins-pvc-232cfef6-a8c0-4d01-9c05-a4cfebe49938`
- 10ê°œ í”„ë¡œì íŠ¸ ëª¨ë‘ ë³µì›ë¨ (tz-drillquiz-operator í¬í•¨)
- Jenkins UI ì •ìƒ ì‘ë™

## âœ… í•´ê²°ë¨: Docker Build ë¬¸ì œ

### ê·¼ë³¸ ì›ì¸
**íƒ€ì´ë° ë¬¸ì œ**: Jenkinsê°€ docker daemonì´ ì™„ì „íˆ ì¤€ë¹„ë˜ê¸° ì „(ì•½ 17ì´ˆ ì†Œìš”)ì— ëª…ë ¹ì„ ì‹¤í–‰

### í•´ê²° ë°©ë²•
docker ì»¨í…Œì´ë„ˆì— **readinessProbe** ì¶”ê°€:
```yaml
readinessProbe:
  exec:
    command: ["docker", "info"]
  initialDelaySeconds: 10
  periodSeconds: 5
  timeoutSeconds: 3
```

### í…ŒìŠ¤íŠ¸ ê²°ê³¼
- docker-test í”„ë¡œì íŠ¸ ë¹Œë“œ #2: âœ… SUCCESS
- docker version: âœ… ì„±ê³µ
- docker info: âœ… ì„±ê³µ
- docker build (Alpine ì´ë¯¸ì§€): âœ… ì„±ê³µ

### ìµœì¢… Pod Template ì„¤ì •
```yaml
spec:
  containers:
  - name: kubectl
    image: doohee323/jenkins-slave
    command: [sleep]
    args: ["9999999"]
    securityContext:
      privileged: true
  - name: jnlp
    image: jenkins/inbound-agent:alpine
  - name: docker
    image: docker:24.0.2-dind
    env:
    - name: DOCKER_TLS_CERTDIR
      value: ""
    securityContext:
      privileged: true
    resources:
      requests:
        memory: 500Mi
      limits:
        memory: 2000Mi
    readinessProbe:  # â­ í•µì‹¬ ì¶”ê°€ ì‚¬í•­
      exec:
        command: ["docker", "info"]
      initialDelaySeconds: 10
      periodSeconds: 5
      timeoutSeconds: 3
```

## âœ… ì™„ë£Œ: Velero ë°±ì—… ì„¤ì • ì„±ê³µ!

### ëª©í‘œ
Kopiaë¥¼ ì‚¬ìš©í•˜ì—¬ Jenkins PV ë°ì´í„°ë¥¼ ì œëŒ€ë¡œ ë°±ì—…

### í•´ê²° ê³¼ì •

#### 1. Helm rollback ì‹¤í–‰
- Revision 2 (v1.17.0) upgrade ì‹¤íŒ¨ â†’ Revision 1 (v1.16.1)ë¡œ rollback
- upgrade-crds Job ì‚­ì œ í•„ìš” (ServiceAccount ì—†ìŒ)
- Helm ë¦´ë¦¬ì¦ˆ ì •ë³´ ì •ë¦¬

#### 2. node-agent DaemonSet ìˆ˜ë™ ë°°í¬
Helm ëŒ€ì‹  ìˆ˜ë™ìœ¼ë¡œ DaemonSet ë°°í¬:
- **í•µì‹¬ ë°œê²¬**: Veleroê°€ ì°¾ëŠ” label selectorê°€ íŠ¹ì •í•´ì•¼ í•¨
  - selector: `name: node-agent` (í•„ìˆ˜!)
  - Pod labels: `name: node-agent`, `role: node-agent`
- ServiceAccount: `velero-server`
- Secret: `credentials-velero`
- SecurityContext:
  - `privileged: true`
  - `runAsUser: 0`
  - `capabilities: [SYS_ADMIN]`
- ë¦¬ì†ŒìŠ¤ ìš”ì²­:
  - CPU: 100m (500mì€ ë„ˆë¬´ ë§ìŒ)
  - Memory: 256Mi

#### 3. ìµœì¢… ë°±ì—… ì„±ê³µ!
**ë°±ì—…ëª…**: `jenkins-complete-20251012-172218`
- **Status**: âœ… **Completed**
- **PodVolumeBackup**: 6ê°œ ëª¨ë‘ Completed
  - âœ… `jenkins-home` (ê°€ì¥ ì¤‘ìš”!)
  - âœ… `jenkins-cache`
  - âœ… `jenkins`
  - âœ… `plugin-dir`
  - âœ… `sc-config-volume`
  - âœ… `tmp-volume`
- **Uploader**: Kopia
- **Duration**: ~2ë¶„ 30ì´ˆ

### í•µì‹¬ êµí›ˆ
1. Velero v1.16.1ì€ Kopia ì‚¬ìš© (Restic ì•„ë‹˜)
2. node-agent DaemonSetì˜ selectorì™€ labelì´ ì •í™•í•´ì•¼ í•¨:
   ```yaml
   selector:
     matchLabels:
       name: node-agent  # í•„ìˆ˜!
   template:
     metadata:
       labels:
         name: node-agent
         role: node-agent
   ```
3. Helm chart í…œí”Œë¦¿ í™•ì¸ì´ ê°€ì¥ ì •í™•í•¨:
   ```
   helm template velero vmware-tanzu/velero --version 10.0.12 --set deployNodeAgent=true --show-only templates/node-agent-daemonset.yaml
   ```

### ìƒì„±ëœ íŒŒì¼
- `/tmp/node-agent-daemonset.yaml`: ìˆ˜ë™ ë°°í¬ìš© DaemonSet ì •ì˜

## ğŸ” í˜„ì¬ í™•ì¸ ì¤‘ì¸ ë¬¸ì œë“¤ (2025-10-14)

### 1. MCP ì„œë²„ 503 ì˜¤ë¥˜ ë¬¸ì œ
**URL**: https://mcp-dev.drillquiz.com/
**ìƒíƒœ**: 503 Service Temporarily Unavailable

**ë¬¸ì œ ë¶„ì„**:
- MCP ì„œë²„ PodëŠ” ì •ìƒ ì‹¤í–‰ ì¤‘ (`1/1 Running`)
- Pod ì§ì ‘ ì ‘ê·¼ ì‹œ ì •ìƒ ì‘ë‹µ (localhost:8080, 8081, 8082 ëª¨ë‘ OK)
- Nginx Ingress Controllerì—ì„œ 503 ë°˜í™˜
- ë¡œê·¸: `request_time: 0.000` (ì¦‰ì‹œ 503 ë°˜í™˜)

**ì›ì¸ ì¶”ì •**:
- Nginx ì„¤ì •ì—ì„œ ì˜ëª»ëœ ë„¤ì„ìŠ¤í˜ì´ìŠ¤/ì„œë¹„ìŠ¤ëª… ì°¸ì¡°
- ì´ì „ ë°°í¬ ì„¤ì •ì´ ë‚¨ì•„ìˆìŒ:
  - ì„¤ì •ëœ ê°’: `namespace: "mcall-system"`, `service_name: "tz-mcall-operator-mcp-server"`
  - ì‹¤ì œ ê°’: `namespace: "mcall-dev"`, `service_name: "tz-mcall-operator-dev-dev-mcp-server"`

**í•´ê²° ì‹œë„**:
- Ingress ì‚­ì œ í›„ ì¬ìƒì„± ì‹œë„ ì¤‘
- Helm upgrade ì§„í–‰ ì¤‘

### 2. PostgreSQL ì´ˆê¸°í™” Job ì‹¤íŒ¨
**Pod**: `tz-mcall-operator-dev-dev-postgres-init-njx6s`
**ìƒíƒœ**: `CrashLoopBackOff`

**ì˜¤ë¥˜ ë©”ì‹œì§€**:
```
psql: error: connection to server at "devops-postgres-postgresql.devops.svc.cluster.local" (10.233.42.5), port 5432 failed: fe_sendauth: no password supplied
```

**ì›ì¸**:
- Secret `tz-mcall-operator-dev-dev-logging-secret`ì˜ `postgresql-password` ê°’ì´ ë¹„ì–´ìˆìŒ
- PostgreSQL ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŒ

**í•´ê²° ì‹œë„**:
- Secret íŒ¨ì¹˜ë¡œ ë¹„ë°€ë²ˆí˜¸ ì„¤ì •: `mcall-dev-password-123`
- Job ì‚­ì œ í›„ ì¬ìƒì„± ì‹œë„ ì¤‘
- Helm upgrade ì§„í–‰ ì¤‘

### 3. Jenkins ë¹Œë“œ #142 ìƒíƒœ
**ë¹Œë“œ ë²ˆí˜¸**: #142
**ë¸Œëœì¹˜**: `origin/mcp`
**ìƒíƒœ**: ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œ
**ë³€ê²½ì‚¬í•­**: TLS ìŠ¤í‚µ ì„¤ì • ì œê±° ì™„ë£Œ

**ìˆ˜í–‰ëœ ì‘ì—…**:
- `insecureSkipVerify: true` ì„¤ì •ì„ ëª¨ë“  MCP í´ë¼ì´ì–¸íŠ¸ ì˜ˆì œì—ì„œ ì œê±°
- ì´ 8ê°œ íŒŒì¼ì—ì„œ 34ì¤„ ì‚­ì œ
- Git ì»¤ë°‹ ë° í‘¸ì‹œ ì™„ë£Œ

### 4. í•´ê²°ëœ ë¬¸ì œë“¤
âœ… **mcp-api-keys Secret ëˆ„ë½**: ìˆ˜ë™ ìƒì„±ìœ¼ë¡œ í•´ê²°
âœ… **MCP ì„œë²„ Pod ì‹œì‘**: Secret ìƒì„± í›„ ì •ìƒ ì‹¤í–‰
âœ… **TLS ìŠ¤í‚µ ì„¤ì • ì œê±°**: ëª¨ë“  ì˜ˆì œ íŒŒì¼ì—ì„œ ì™„ë£Œ

### 5. í•´ê²°ëœ ë¬¸ì œë“¤ (2025-10-14 ì—…ë°ì´íŠ¸)
âœ… **PostgreSQL ì´ˆê¸°í™” Job**: Secret íŒ¨ì¹˜ë¡œ í•´ê²° (ë¹„ë°€ë²ˆí˜¸ ì„¤ì • ì™„ë£Œ)
âœ… **MCP ì„œë²„ Pod**: ì •ìƒ ì‹¤í–‰ ì¤‘, ì§ì ‘ ì ‘ê·¼ ì‹œ 200 OK ì‘ë‹µ
âœ… **Helm upgrade**: ì™„ë£Œë¨

### 6. âœ… í•´ê²°ë¨: MCP ì„œë²„ 503 ì˜¤ë¥˜ (2025-10-14 03:09)
**ì›ì¸**: ê°™ì€ í˜¸ìŠ¤íŠ¸ëª… `mcp-dev.drillquiz.com`ì„ ì‚¬ìš©í•˜ëŠ” ë‘ ê°œì˜ Ingress ì¶©ëŒ
- `mcall-dev` ë„¤ì„ìŠ¤í˜ì´ìŠ¤: ì •ìƒ ì‘ë™í•˜ëŠ” Ingress
- `mcall-system` ë„¤ì„ìŠ¤í˜ì´ìŠ¤: ImagePullBackOffë¡œ ì‹¤íŒ¨í•œ Ingress

**í•´ê²°**: `mcall-system` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ ì¶©ëŒí•˜ëŠ” Ingress ì‚­ì œ
- âœ… https://mcp-dev.drillquiz.com/ ì ‘ê·¼ ì •ìƒ (200 OK)
- âœ… MCP ì„œë²„ ì™¸ë¶€ ì ‘ê·¼ ì™„ì „ ë³µì›

### 7. âœ… í•´ê²°ë¨: ìš´ì˜ í™˜ê²½ MCP ì„œë²„ ë³µì› (2025-10-14 03:11)
**ë¬¸ì œ**: ìš´ì˜ í™˜ê²½(`mcall-system`)ì˜ MCP ì„œë²„ê°€ ImagePullBackOff ìƒíƒœ
- ì´ë¯¸ì§€ íƒœê·¸: `:latest` (ì¡´ì¬í•˜ì§€ ì•ŠìŒ)
- Ingress ë„ë©”ì¸: `mcp-dev.drillquiz.com` (ê°œë°œ í™˜ê²½ê³¼ ì¶©ëŒ)

**í•´ê²°**:
1. MCP ì„œë²„ ì´ë¯¸ì§€ íƒœê·¸ë¥¼ `:142`ë¡œ ìˆ˜ì • (ê°œë°œ í™˜ê²½ê³¼ ë™ì¼)
2. ìš´ì˜ í™˜ê²½ìš© Ingressë¥¼ ì˜¬ë°”ë¥¸ ë„ë©”ì¸ `mcp.drillquiz.com`ìœ¼ë¡œ ì¬ìƒì„±
3. SSL ì¸ì¦ì„œ ìë™ ë°œê¸‰ ì„¤ì •

**ê²°ê³¼**:
- âœ… https://mcp.drillquiz.com/ ì ‘ê·¼ ì •ìƒ (200 OK)
- âœ… ìš´ì˜ í™˜ê²½ MCP ì„œë²„ ì™„ì „ ë³µì›
- âœ… í™˜ê²½ë³„ ë„ë©”ì¸ ë¶„ë¦¬ ì™„ë£Œ

### 8. âœ… í•´ê²°ë¨: MCP API ì¸ì¦ ë¬¸ì œ (2025-10-14 03:12)
**ë¬¸ì œ**: MCP API ì ‘ê·¼ ì‹œ 401 Unauthorized ì˜¤ë¥˜
- URL: https://mcp-dev.drillquiz.com/api/workflows/mcall-dev/health-monitor/dag

**ì›ì¸**: API Key ì¸ì¦ì´ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë‚˜ í—¤ë”ì— í¬í•¨ë˜ì§€ ì•ŠìŒ

**í•´ê²°**: `X-API-Key` í—¤ë”ì— API Key í¬í•¨
- ê°œë°œ í™˜ê²½ API Key: `dev-key-123`, `test-key-456`
- ì‚¬ìš©ë²•: `curl -H "X-API-Key: dev-key-123" https://mcp-dev.drillquiz.com/api/...`

**ê²°ê³¼**:
- âœ… MCP API ì •ìƒ ì ‘ê·¼ (200 OK)
- âœ… ì›Œí¬í”Œë¡œìš° ìƒíƒœ ì¡°íšŒ ê°€ëŠ¥
- âœ… DAG ì •ë³´ ì •ìƒ ë°˜í™˜

### 9. âœ… í•´ê²°ë¨: MCP í´ë¼ì´ì–¸íŠ¸ ì˜¤ë¥˜ ë©”ì‹œì§€ ê°œì„  (2025-10-14 03:15)
**ë¬¸ì œ**: Jenkins MCP íƒœìŠ¤í¬ì—ì„œ ìƒì„¸í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ
- ì—ëŸ¬ ë©”ì‹œì§€: `empty command` (ë„ˆë¬´ ì¼ë°˜ì )
- ì‹¤ì œ ì›ì¸: Jenkins MCP ì„œë²„ì˜ SSE ì‘ë‹µ í˜•ì‹ ë¯¸ì§€ì›

**ì›ì¸ ë¶„ì„**:
1. **Jenkins MCP ì¸ì¦ ì •ë³´**: `jenkins-mcp-credentials` Secretì—ì„œ í™•ì¸
   - Username: `admin`
   - Token: `11197fa40f409842983025803948aa6bcc`
2. **ì‘ë‹µ í˜•ì‹**: Jenkins MCP ì„œë²„ëŠ” Server-Sent Events (SSE) í˜•ì‹ ì‚¬ìš©
   ```
   id: 5fccc81a-50ec-4d21-bf0c-652bf3fb9394
   event: message
   data: {"jsonrpc":"2.0","id":2,"result":{"content":[{"type":"text","text":"true"}],"isError":false}}
   ```
3. **ì„¸ì…˜ ê´€ë¦¬**: `mcp-session-id` í—¤ë”ë¡œ ì„¸ì…˜ ê´€ë¦¬

**í•´ê²°**:
1. MCP í´ë¼ì´ì–¸íŠ¸ì˜ ì˜¤ë¥˜ ì²˜ë¦¬ ë¡œì§ ê°œì„ 
2. SSE ì‘ë‹µ í˜•ì‹ íŒŒì‹± ì¶”ê°€
3. ì„¸ì…˜ ID ì¶”ì¶œ ë¡œì§ ê°•í™” (í—¤ë” + ì‘ë‹µ ë³¸ë¬¸)
4. ìƒì„¸í•œ ì˜¤ë¥˜ ë¡œê¹… ì¶”ê°€

**ê²°ê³¼**:
- âœ… Jenkins MCP ì„œë²„ì™€ ì •ìƒ í†µì‹  í™•ì¸
- âœ… `triggerBuild` ë„êµ¬ í˜¸ì¶œ ì„±ê³µ (`"text":"true"`)
- âœ… ë” ìƒì„¸í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ ê°€ëŠ¥
- âœ… ì½”ë“œ ìˆ˜ì •ì‚¬í•­ ì»¤ë°‹ ë° í‘¸ì‹œ ì™„ë£Œ

### 10. âœ… í•´ê²°ë¨: GitHub Webhook ìë™ ë¹Œë“œ ì„±ê³µ (2025-10-14 03:42)
**ë¬¸ì œ**: GitHubì—ì„œ ì½”ë“œ í‘¸ì‹œ ì‹œ Jenkins ë¹Œë“œê°€ ìë™ìœ¼ë¡œ íŠ¸ë¦¬ê±°ë˜ì§€ ì•ŠìŒ

**ì›ì¸ ë¶„ì„**:
1. **Content-Type ë¶ˆì¼ì¹˜**: GitHub webhookì´ `application/x-www-form-urlencoded` í˜•ì‹ìœ¼ë¡œ ì „ì†¡
2. **Jenkins GitHub í”ŒëŸ¬ê·¸ì¸**: `application/json` í˜•ì‹ ê¸°ëŒ€
3. **íŒŒì‹± ì‹¤íŒ¨**: "Unknown content type null" ì˜¤ë¥˜ ë°œìƒ

**í•´ê²° ê³¼ì •**:
1. GitHub ë¦¬í¬ì§€í† ë¦¬ì—ì„œ webhook ì„¤ì • ìˆ˜ì •
   - Content-Type: `application/x-www-form-urlencoded` â†’ `application/json`
2. Jenkins GitHub í”ŒëŸ¬ê·¸ì¸ webhook ì¬ë“±ë¡
3. GitHubì—ì„œ í…ŒìŠ¤íŠ¸ push ì‹¤í–‰

**ê²°ê³¼**:
- âœ… **Jenkins Build #142 ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë¨**
- âœ… ë¹Œë“œ ê²°ê³¼: SUCCESS
- âœ… ë¹Œë“œ ì‹œê°„: ì•½ 10ë¶„ (622ì´ˆ)
- âœ… GitHub webhookì´ ì •ìƒì ìœ¼ë¡œ Jenkins ë¹Œë“œ íŠ¸ë¦¬ê±°

**í˜„ì¬ ìƒíƒœ**:
- âœ… GitHub webhook ìë™ ë¹Œë“œ ì™„ì „ ì‘ë™
- âœ… ì½”ë“œ ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ Jenkins ë¹Œë“œ ì‹¤í–‰
- âœ… MCP í´ë¼ì´ì–¸íŠ¸ ì˜¤ë¥˜ ì²˜ë¦¬ ê°œì„  ì™„ë£Œ
- âœ… Jenkins Docker agent ìŠ¤ì¼€ì¤„ë§ ë¬¸ì œ í•´ê²° ì™„ë£Œ
- âœ… MCP Server DAG API errorMessage í•„ë“œ ëˆ„ë½ ë¬¸ì œ ìˆ˜ì • ì™„ë£Œ
- âš ï¸ Jenkins í”„ë¡œì íŠ¸ ì„¤ì • ì†ì‹¤ (API í˜¸ì¶œë¡œ ì¸í•œ ì´ˆê¸°í™”)
- âš ï¸ MCP Server ìƒˆ ì´ë¯¸ì§€ ë°°í¬ í•„ìš” (ë¡œì»¬ Docker ë¯¸ì‹¤í–‰)

## ğŸš¨ **Jenkins Docker Agent ìŠ¤ì¼€ì¤„ë§ ë¬¸ì œ í•´ê²° (2025-10-13 21:00)**

### ğŸ“Š **ë¬¸ì œ ìƒí™©**
- **Error**: `0/3 nodes are available: 1 node(s) had untolerated taint {node-role.kubernetes.io/control-plane: }, 2 Insufficient cpu`
- **ì›ì¸**: 
  - kube-master ë…¸ë“œì— `NoSchedule` í…Œì¸íŠ¸
  - kube-node-1, kube-node-2 CPU ë¦¬ì†ŒìŠ¤ ë¶€ì¡± (95%, 96% ì‚¬ìš©ë¥ )
- **í•´ê²° ë°©ë²•**:
  1. kube-master í…Œì¸íŠ¸ ì œê±°: `kubectl taint nodes kube-master node-role.kubernetes.io/control-plane:NoSchedule-`
  2. ë¶ˆí•„ìš”í•œ Pod ì •ë¦¬ (ImagePullBackOff, Completed ìƒíƒœ)
  3. ë¦¬ì†ŒìŠ¤ ì •ë¦¬ë¡œ ìŠ¤ì¼€ì¤„ë§ ê³µê°„ í™•ë³´

### âœ… **í•´ê²° ê²°ê³¼**
- Jenkins Docker agent Podê°€ kube-master ë…¸ë“œì— ì„±ê³µì ìœ¼ë¡œ ìŠ¤ì¼€ì¤„ë¨
- Pod ìƒíƒœ: PodInitializing â†’ ì •ìƒ ì‹¤í–‰ ì¤‘
- ëª¨ë“  3ê°œ ë…¸ë“œì—ì„œ Pod ìŠ¤ì¼€ì¤„ë§ ê°€ëŠ¥

## ğŸš¨ **Jenkins í”„ë¡œì íŠ¸ ì„¤ì • ì†ì‹¤ ë¬¸ì œ (2025-10-13 21:00)**

### ğŸ“Š **ë¬¸ì œ ìƒí™©**
- **Jenkins í”„ë¡œì íŠ¸ ì„¤ì •ì´ ì‚¬ë¼ì§**: API í˜¸ì¶œë¡œ ì¸í•œ ì„¤ì • ì´ˆê¸°í™”
- **ì†ì‹¤ëœ ì„¤ì •ë“¤**:
  - Pipeline ìŠ¤í¬ë¦½íŠ¸ ë‚´ìš©
  - GitHub webhook trigger ì„¤ì •
  - Remote trigger í† í° (`github-webhook-token-2024`)
- **ì›ì¸**: ì´ì „ API í˜¸ì¶œì´ ê¸°ì¡´ ì„¤ì •ì„ ë®ì–´ì”€

### ğŸ”§ **í•´ê²° ë°©ë²•**
- Jenkins ì›¹ UIì—ì„œ ì§ì ‘ ì„¤ì • ë³µì› í•„ìš”
- API ëŒ€ì‹  ì›¹ UI ì‚¬ìš© ê¶Œì¥

## ì°¸ê³  íŒŒì¼
- ì›ë³¸ Helm values: `/Volumes/workspace/tz/tz-k8s-vagrant/tz-local/resource/jenkins/helm/values.yaml`
- í”ŒëŸ¬ê·¸ì¸ ëª©ë¡: `/Volumes/workspace/tz/tz-k8s-vagrant/tz-local/resource/jenkins/helm/plugin.txt`
- ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸: `/Volumes/workspace/tz/tz-k8s-vagrant/tz-local/resource/jenkins/helm/install.sh`
- Velero values (ìˆ˜ì •): `/tmp/velero-values.yaml`

